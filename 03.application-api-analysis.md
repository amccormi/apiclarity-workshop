# 03. Application API analysis

## Task 3. Deploy BookInfo Application

Run the following command to install the BookInfo application:

```bash
kubectl apply -f $HOME/lab/bookinfo/bookinfo.yaml --namespace=bookinfo
```

You should have a similar output:

```console
service/details created
serviceaccount/bookinfo-details created
deployment.apps/details-v1 created
service/ratings created
serviceaccount/bookinfo-ratings created
deployment.apps/ratings-v1 created
service/reviews created
serviceaccount/bookinfo-reviews created
deployment.apps/reviews-v1 created
deployment.apps/reviews-v2 created
deployment.apps/reviews-v3 created
service/productpage created
serviceaccount/bookinfo-productpage created
deployment.apps/productpage-v1 created
configmap/reviews-inject-config created
deployment.apps/reviews-inject-v1 created
```

## Task 4. Analyse API traffic on APIClarity

Open the web UI of APIClarity. Refresh the page if you don't find captured traffic.

![](./images/2022-10-26-14-26-51.png)

## Task 5. Reconstruct API schema.

Under the API inventory you will find three discovered APIs:

* reviews.bookinfo
* ratings.bookinfo
* details.bookinfo

![](./images/2022-10-26-14-30-47.png)

Use APIClarity's capability to reconstruct an OpenAPI schema based on the captured traffic.
Reconstruct the schema for the three APIs.


![](./images/2022-10-26-14-28-45.png)


Click all paths and approve review.

![](./images/2022-10-26-14-32-48.png)

Choose OAS V3

![](./images/2022-10-26-14-33-34.png)

Once the schema is generated, you can review it in Swagger.

![](./images/2022-10-26-14-34-23.png)

## Task 6. Analysis of API difference

Once a schema is loaded by the user or reconstructed by APIClarity,
The application is using to compare running traffic towards the blueprint.

Use the API Events page to find for traffic which does not respect the schema:

![](./images/2022-10-26-14-37-23.png)

Review an event with alert.

![](./images/2022-10-26-14-37-52.png)

To approve the diff,